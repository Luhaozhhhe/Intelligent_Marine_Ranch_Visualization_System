{% extends 'layouts/base.html' %}

{% block title %} Charts {% endblock title %}

<!-- Specific CSS goes HERE -->
{% block stylesheets %}{% endblock stylesheets %}

{% block content %}

  <div class="min-height-300 bg-primary position-absolute w-100"></div>

  {% include "includes/sidenav.html" %}

  <main class="main-content position-relative border-radius-lg ">
    {% include "includes/navigation.html" %}
    <div class="container-fluid py-4">
      <div class="row">
        <!-- [ Bar Chart ] start -->
        <div class="col-sm-12 col-md-6">
          <div class="card">
            <div class="card-header">
              <h5>Bar Chart</h5>
            </div>
            <div class="card-body text-center">
              <div id="bar-chart"></div>
            </div>
          </div>
        </div>
        <!-- [ Bar Chart ] end -->

        <!-- [ Pie Chart ] start -->
        <div class="col-sm-12 col-md-6">
          <div class="card">
            <div class="card-header">
              <h5>Pie Chart</h5>
            </div>
            <div class="card-body text-center">
              <div id="pie-chart"></div>
            </div>
          </div>
        </div>
        <!-- [ Pie Chart ] end -->
      </div>
    </div>
  </main>

{% endblock content %}

{% block javascripts %}
<script src="https://cdn.jsdelivr.net/npm/apexcharts"></script>
<script>
  document.addEventListener("DOMContentLoaded", function() {
    var products = JSON.parse('{{ products | tojson | safe }}');
    var names = products.map(p => p.name);
    var prices = products.map(p => p.price);

    var barOptions = {
      chart: { type: 'bar', height: 350 },
      series: [{ name: 'Price', data: prices }],
      xaxis: { categories: names }
    };
    var barChart = new ApexCharts(document.querySelector("#bar-chart"), barOptions);
    barChart.render();

    var pieOptions = {
      chart: { type: 'pie', height: 350 },
      series: prices,
      labels: names
    };
    var pieChart = new ApexCharts(document.querySelector("#pie-chart"), pieOptions);
    pieChart.render();
  });
</script>
{% endblock javascripts %}
